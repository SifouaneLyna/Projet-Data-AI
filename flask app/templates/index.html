<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Prédiction de Prix Immobiliers - ImmoDZ</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: #ececec;
      }
      .box-area {
        width: 1300px;
        padding: 30px;
      }
      .left-box,
      .right-box {
        padding: 30px;
        min-height: 400px;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }
      .form-container {
        min-height: 350px;
      }
      .form-label {
        font-weight: 500;
      }
      .form-control,
      .form-select {
        font-size: 0.9rem;
        padding: 10px;
      }
      .form-control:hover,
      .form-select:hover {
        border-color: #c874c8;
        background-color: rgba(217, 132, 216, 0.1);
      }
      .form-control:focus,
      .form-select:focus {
        border-color: #d984d8;
        box-shadow: 0 0 0 0.2rem rgba(217, 132, 216, 0.25);
        background-color: #fff;
      }
      .form-group {
        margin-bottom: 20px;
      }
      .error-text {
        color: #ff0000;
        font-size: 0.8rem;
        margin-top: 5px;
        display: block;
      }
      .result,
      .submitted-info {
        text-align: left;
      }
      .result p,
      .submitted-info p {
        margin-bottom: 15px;
      }
      .result span,
      .submitted-info span {
        color: #d984d8;
        font-weight: 500;
      }
      .error {
        color: #ff0000;
      }
      .btn-primary {
        background-color: #d984d8;
        border-color: #d984d8;
      }
      .btn-primary:hover {
        background-color: #c874c8;
        border-color: #c874c8;
      }
      .btn-primary:active {
        background-color: #b964b8 !important;
        border-color: #b964b8 !important;
      }
      .form-check-input:checked {
        background-color: #d984d8;
        border-color: #d984d8;
      }
      .form-check-input:focus {
        border-color: #c874c8;
        box-shadow: 0 0 0 0.2rem rgba(217, 132, 216, 0.25);
      }
      .immodz-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #d984d8;
        text-align: center;
        margin-bottom: 20px;
      }
      @media only screen and (max-width: 768px) {
        .box-area {
          margin: 0 10px;
          width: 100%;
          padding: 15px;
        }
        .left-box,
        .right-box {
          padding: 20px;
          min-height: 300px;
        }
        .form-container {
          min-height: 250px;
        }
      }
    </style>
  </head>
  <body>
    <div
      class="container d-flex justify-content-center align-items-center min-vh-100"
    >
      <div
        class="row border rounded-5 bg-white shadow box-area d-flex flex-row"
      >
        <div class="col-12">
          <h1 class="immodz-title">ImmoDZ</h1>
        </div>
        <div class="col-md-6 left-box border-end">
          <div class="form-container">
            <h5 class="text-center mb-4">Informations sur la propriété</h5>
            <form method="POST">
              <div class="form-group">
                <label for="surface" class="form-label">Surface (m²)</label>
                <input
                  type="number"
                  class="form-control bg-light"
                  name="surface"
                  id="surface"
                  min="1"
                  step="0.1"
                  placeholder="ex. 120"
                />
                {% if errors.surface %}
                <small class="error-text">{{ errors.surface }}</small>
                {% endif %}
              </div>
              <div class="form-group">
                <label class="form-label d-block">Type de propriété</label>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="main_property_type"
                    id="apartment"
                    value="Apartment"
                  />
                  <label class="form-check-label" for="apartment"
                    >Appartement</label
                  >
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="main_property_type"
                    id="villa"
                    value="Villa"
                  />
                  <label class="form-check-label" for="villa">Villa</label>
                </div>
                <div class="form-check form-check-inline">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="main_property_type"
                    id="terrain"
                    value="Terrain"
                  />
                  <label class="form-check-label" for="terrain">Terrain</label>
                </div>
                {% if errors.main_property_type %}
                <small class="error-text"
                  >{{ errors.main_property_type }}</small
                >
                {% endif %}
              </div>
              <div
                class="form-group"
                id="apartment_options"
                style="display: none"
              >
                <label for="property_type" class="form-label"
                  >Type d'appartement</label
                >
                <select
                  class="form-select bg-light"
                  name="property_type"
                  id="property_type_select"
                >
                  <option value="">-- Sélectionner --</option>
                  <option value="F1">F1</option>
                  <option value="F2">F2</option>
                  <option value="F3">F3</option>
                  <option value="F4">F4</option>
                  <option value="F5">F5</option>
                  <option value="F6">F6</option>
                  <option value="F7">F7</option>
                  <option value="F8">F8</option>
                </select>
                {% if errors.property_type %}
                <small class="error-text">{{ errors.property_type }}</small>
                {% endif %}
              </div>
              <input
                type="hidden"
                name="property_type"
                id="hidden_property_type"
              />
              <div class="form-group">
                <label for="town" class="form-label">Ville</label>
                <select class="form-select bg-light" name="town" id="town">
                  <option value="">-- Sélectionner la ville --</option>
                  <option>Ain benian</option>
                  <option>Ain naadja</option>
                  <option>Ain taya</option>
                  <option>Alger centre</option>
                  <option>Bab el oued</option>
                  <option>Bab ezzouar</option>
                  <option>Baba hassen</option>
                  <option>Bachdjerrah</option>
                  <option>Baraki</option>
                  <option>Belouizdad</option>
                  <option>Ben aknoun</option>
                  <option>Beni messous</option>
                  <option>Bir mourad rais</option>
                  <option>Birkhadem</option>
                  <option>Birtouta</option>
                  <option>Bologhine</option>
                  <option>Bordj el bahri</option>
                  <option>Bordj el kiffan</option>
                  <option>Bourouba</option>
                  <option>Bouzareah</option>
                  <option>Casbah</option>
                  <option>Cheraga</option>
                  <option>Chevalley</option>
                  <option>Dar el beida</option>
                  <option>Dely brahim</option>
                  <option>Douera</option>
                  <option>Draria</option>
                  <option>El achour</option>
                  <option>El biar</option>
                  <option>El harrach</option>
                  <option>El madania</option>
                  <option>El magharia</option>
                  <option>El marsa</option>
                  <option>El mouradia</option>
                  <option>Gue de constantine</option>
                  <option>Hammamet</option>
                  <option>Hraoua</option>
                  <option>Hussein dey</option>
                  <option>Hydra</option>
                  <option>Khraissia</option>
                  <option>Kouba</option>
                  <option>Les eucalyptus</option>
                  <option>Mahelma</option>
                  <option>Mohammadia</option>
                  <option>Oued koriche</option>
                  <option>Oued smar</option>
                  <option>Ouled chebel</option>
                  <option>Ouled fayet</option>
                  <option>Rahmania</option>
                  <option>Rais hamidou</option>
                  <option>Reghaia</option>
                  <option>Rouiba</option>
                  <option>Said hamdine</option>
                  <option>Saoula</option>
                  <option>Sidi mhamed</option>
                  <option>Sidi moussa</option>
                  <option>Souidania</option>
                  <option>Staoueli</option>
                  <option>Tessala el merdja</option>
                  <option>Zeralda</option>
                </select>
                {% if errors.town %}
                <small class="error-text">{{ errors.town }}</small>
                {% endif %}
              </div>
              <div class="d-grid">
                <button type="submit" class="btn btn-primary btn-sm">
                  Prédire
                </button>
              </div>
            </form>
          </div>
        </div>
        <div class="col-md-6 right-box">
          <h5 class="text-center mb-4">Prédictions</h5>
          {% if result %} {% if errors.general %}
          <div class="result error text-center">{{ errors.general }}</div>
          {% else %}
          <div class="submitted-info">
            <p>Surface: <span>{{ submitted_info.surface }} m²</span></p>
            <p>
              Type de propriété: <span>{{ submitted_info.property_type }}</span>
            </p>
            <p>Ville: <span>{{ submitted_info.town }}</span></p>
          </div>
          <div class="result">
            <p>
              Prix exact:
              <span
                >{{ result.predicted_price }} DZD ({{
                result.predicted_price_centimes }})</span
              >
            </p>
            <p>
              Prix minimum:
              <span
                >{{ result.min_price }} DZD ({{ result.min_price_centimes
                }})</span
              >
            </p>
            <p>
              Prix maximum:
              <span
                >{{ result.max_price }} DZD ({{ result.max_price_centimes
                }})</span
              >
            </p>
          </div>
          {% endif %} {% else %}
          <p class="text-muted text-center">
            Le résultat apparaîtra ici après soumission du formulaire.
          </p>
          {% endif %}
        </div>
      </div>
    </div>

    <script>
      const apartmentRadio = document.getElementById("apartment");
      const villaRadio = document.getElementById("villa");
      const terrainRadio = document.getElementById("terrain");
      const apartmentOptions = document.getElementById("apartment_options");
      const hiddenInput = document.getElementById("hidden_property_type");
      const apartmentSelect = document.getElementById("property_type_select");

      function updatePropertyType() {
        if (apartmentRadio.checked) {
          apartmentOptions.style.display = "block";
          hiddenInput.disabled = true;
          apartmentSelect.disabled = false;
          hiddenInput.value = "";
        } else {
          apartmentOptions.style.display = "none";
          apartmentSelect.disabled = true;
          hiddenInput.disabled = false;
          hiddenInput.value = villaRadio.checked
            ? "Villa"
            : terrainRadio.checked
            ? "Terrain"
            : "";
        }
      }

      apartmentRadio.addEventListener("change", updatePropertyType);
      villaRadio.addEventListener("change", updatePropertyType);
      terrainRadio.addEventListener("change", updatePropertyType);
      updatePropertyType();
    </script>
  </body>
</html>
